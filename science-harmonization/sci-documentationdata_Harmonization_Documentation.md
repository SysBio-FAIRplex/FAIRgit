***This is the working doc for the Science and Data Harmonization Core***

![main_image](assets/image_1.png)

# **Introduction**

### The SysBio FAIRplex teams are developing a federated data platform designed to promote collaborative, transparent, and reproducible research following FAIR principles. The FAIRplex platform will enable researchers to discover and access data from the Accelerating Medicines Partnership¬Æ (AMP¬Æ) program[^merged_core_dti_docs-1]. Central to the platform will be a catalog of AMP datasets that are harmonized into a Common Data Model (SysBio CDM) for indexing, search, and combined analysis. The CDM will leverage foundational data engineering efforts and guidelines preceding the SysBio FAIRplex, such as Ontology for Biomedical Investigations (OBI)[^merged_core_dti_docs-2], Common Fund Data Ecosystem (CFDE)[^merged_core_dti_docs-3], Observational Medical Outcomes Partnership (OMOP)[^merged_core_dti_docs-4], and the NLM CDE Repository[^merged_core_dti_docs-5].

[^merged_core_dti_docs-1]: <https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247>

[^merged_core_dti_docs-2]: <https://www.nature.com/articles/npre.2009.3482.1>

[^merged_core_dti_docs-3]: <https://www.ohdsi.org/data-standardization/>

[^merged_core_dti_docs-4]: <https://www.nature.com/articles/s41592-019-0619-0>

[^merged_core_dti_docs-5]: <https://www.nature.com/articles/s41531-022-00288-w>

This documentation describes the SysBio FAIRplex data landscape, data processing, and data model. The SysBio FAIRplex platform will serve as a central location for performing data discovery through FAIRkit[^merged_core_dti_docs-6], data exploration through visualization tools, and data analysis through Workbench[^merged_core_dti_docs-7].

[^merged_core_dti_docs-6]: <https://pmc.ncbi.nlm.nih.gov/articles/PMC8422160/>

[^merged_core_dti_docs-7]: <https://pubmed.ncbi.nlm.nih.gov/38168437/>

This documentation is maintained in FAIRgit[^merged_core_dti_docs-8], the central GitHub organization for the SysBio FAIRplex Project. It was generated by the Science and Data Harmonization Core. Additional documentation is being generated by the Security and Data Governance Core[^merged_core_dti_docs-9] and the Platform and Tools Core[^merged_core_dti_docs-10].

[^merged_core_dti_docs-8]: <https://pubmed.ncbi.nlm.nih.gov/38585876/>

[^merged_core_dti_docs-9]: <https://pubmed.ncbi.nlm.nih.gov/30279509/>

[^merged_core_dti_docs-10]: [https://docs.google.com/document/d/1Im4XDBghVmgdPPercQi4Vg1aODB6kbfam1h10zqTHIM/edit?tab=t.g9ozssacnemv\\#heading=h.gwp92a45r22t](https://docs.google.com/document/d/1Im4XDBghVmgdPPercQi4Vg1aODB6kbfam1h10zqTHIM/edit?tab=t.g9ozssacnemv\#heading=h.gwp92a45r22t){.uri}

Please see the ‚ÄúIn Practice‚Äù section of this document for details on how to operationalize the practices outlined throughout this document.

------------------------------------------------------------------------

# Definitions

These definitions are relevant to this documentation. A SysBio FAIRplex combined list of definitions is being developed here: [SysBio Glossary](https://docs.google.com/document/d/1lGIz8AxHoOfPv1tzPSf9OFi9yestlKorDnNbsu3yl80/edit?tab=t.0#heading=h.bmufyarfq17e)

| Term | Description |
|:-----------------------------------|:-----------------------------------|
| AMP Portal | A general term for platforms hosting AMP project data |
| AMP Program | The FNIH term for the whole program |
| AMP Project | The FNIH term for individual AMPs |
| Centralized data | Data hosted in one repository |
| Dataset | A structured, provenance-tracked collection of information elements with a defined schema and explicit terms of use and stewardship, that supports discovery, access, interpretation, and reuse according to FAIR principles. Different repositories have flexibility in how they translate their data into a FAIRplex Dataset, which may be driven by practical, real-world scientific use-cases. In practice, a Dataset should fall under a single data use access process. Different tiers (registered, controlled, controlled plus) may have different activities to receive access approval. |
| Federated data | Interoperable data hosted in multiple repositories |
| Genetics assays | Assays that target DNA, including but not limited to whole genome sequencing, array genotyping, and/or imputation of genotypes |
| Harmonized data | Data that has been processed jointly using the same or functionally equivalent pipelines. Data that can be easily centralized. Harmonized data is inherently interoperable. |
| Interoperable data | Data that has been processed using different pipelines. Data is made interoperable through the same headers and content representations across studies. |
| Metadata | FAIRplex uses the term ‚Äúmetadata‚Äù in its classical sense of ‚Äúdata about data‚Äù. We apply the term to datasets and samples. We do NOT apply the term to phenotypic/clinical data from research study participants. |
| Omics assays | Assays that target RNA, Proteins, Metabolites, and other molecules, generally with the gene as a functional unit for analyses |
| Summary data | Aggregate analysis results |
| Synthetic data | Data that has been randomized and fully anonymized |

------------------------------------------------------------------------

# **SysBio FAIRplex: Operationalizing the Common Data Model**

## **A Guide to FAIR Data Practices Through User Journeys**

Science and Data Harmonization Core

October 2025

------------------------------------------------------------------------

## **Executive Summary**

The SysBio FAIRplex platform enables cross-disease systems biology research by making Accelerating Medicines Partnership (AMP) data Findable, Accessible, Interoperable, and Reusable (FAIR). This document demonstrates how researchers operationalize the SysBio Common Data Model (CDM) through two distinct user journeys:

1.  **The Data Consumer**: Uses FAIRkit to discover federated data, build cohorts, and analyze interoperable datasets in Verily Workbench

2.  **The Data Producer**: Makes siloed genetic, clinical, and multi-omic data interoperable for cross-study meta-analyses

Both journeys leverage Common Data Elements (CDEs), standardized pipelines, and open-source code shared via FAIRgit.

------------------------------------------------------------------------

## **The SysBio FAIRplex Ecosystem Overview**

### **Core Components**

**FAIRkit**: Search and discovery tool for finding datasets across AMP programs - Dataset Explorer: Browse CDEs and dataset-level metadata - Federated Browser: Query harmonized data with federated authentication - Cohort Builder: Create ‚Äúshopping lists‚Äù of samples across multiple AMPs

**SysBio CDM**: Common Data Model based on OMOP, extended for genetics and omics - Clinical data: OMOP-compliant relational tables - Genetics: PLINK2 format with standardized variant naming - Omics: HDF5 format with normalized, scaled counts per gene

**FAIRgit**: Central GitHub organization for reproducible code and documentation

**Verily Workbench**: Cloud-based analysis environment with access to expansive centralized/federated data

**SysBio Portal**: Public-facing visualization of summary-level data and connections to other sources

### **Data Architecture**
---

## **DATA STRUCTURE**

---

<details>
<summary><strong>üìÅ harmonized_$(date)/</strong></summary>

```
clinical_meta/
‚îî‚îÄ‚îÄ tabular_data.hdf            # OMOP-compliant CDEs

bulk_omics/
‚îî‚îÄ‚îÄ tabular_data.hdf            # Normalized counts, z-scored

cell_omics/
‚îî‚îÄ‚îÄ tabular_data.hdf            # Pseudobulked, cell-type annotated

genetics/
‚îú‚îÄ‚îÄ tabular_data.hdf            # Variant annotations + covariates
‚îú‚îÄ‚îÄ imputed_data.pgen           # PLINK format
‚îî‚îÄ‚îÄ joint_call.pgen             # PLINK format
```
</details>

<details>
<summary><strong>üìÅ summary_$(date)/</strong></summary>

```
bulk_omics/
‚îú‚îÄ‚îÄ differential_expression.hdf
‚îú‚îÄ‚îÄ networks.hdf
‚îî‚îÄ‚îÄ PCA.hdf

cell_omics/
‚îî‚îÄ‚îÄ differential_expression.hdf

genetics/
‚îî‚îÄ‚îÄ GWAS.hdf
```
</details>

------------------------------------------------------------------------

## **User Journey 1: The Data Consumer**

### **Finding, Exploring, and Analyzing Federated Data**

**Persona**: Dr.¬†Sarah Chen, a mid-career computational biologist investigating inflammatory signatures across neurodegenerative diseases (Alzheimer‚Äôs, Parkinson‚Äôs) and autoimmune conditions (RA, SLE).

### **Phase 1: Discovery with FAIRkit**

#### *Step 1: Discovery of FAIRkit through the SysBio FAIRplex Portal*

Sarah explores the SysBio FAIRplex Portal for documentation and tools

#### *Step 2: Federated Authentication*

<p align="center">
<code>FAIRkit User</code> ‚ûú <code>FAIRplex Service</code> ‚ûú <code>Passport Broker (RAS)</code>
<br><br>
‚¨áÔ∏è
<br><br>
<code>AMP-AD Visa</code>‚ÄÉ‚ÄÉ<code>AMP-PD Visa</code>
</p>

Her authenticated session now provides access to datasets across AMP AD, AMP PD, AMP RA/SLE, and AMP X based on her approved Data Access Requests (DARs).

#### *Step 3: Dataset Search and Exploration*

Sarah navigates to the **FAIRkit Dataset Explorer** and searches for: - **Disease focus**: Alzheimer‚Äôs disease, Parkinson‚Äôs disease, Rheumatoid Arthritis - **Data modalities**: Genomics (bulk RNA-seq), Genetics (WGS) - **Biospecimen**: Brain tissue, Blood

The search returns 7 datasets similar to below:

| Study | AMP | Disease Focus | Data Types | Biospecimen | Access |
|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|
| ROSMAP | AMP AD | Alzheimer‚Äôs | Genomics, Genetics, Clinical | Brain | Open + Controlled |
| MSBB | AMP AD | Alzheimer‚Äôs | Genomics, Genetics | Brain | Controlled |
| HBS | AMP PD | Parkinson‚Äôs | Genomics, Genetics | Brain, Blood | Controlled |
| RA_Phase1 | AMP RA/SLE | RA | Genomics, Genetics | Blood | Controlled |

Each dataset displays: - **Consent codes** (e.g., HMB, DS-CVD) via GA4GH DUO terms - **Sample counts** stratified by case/control - **Common Data Elements** available (age, sex, disease duration, APOE genotype, etc.) - **Data location** (AMP portal + FAIRplex bucket)

#### *Step 4: Exploring Harmonized Metadata*

Sarah selects **ROSMAP, MSBB** and **HBS** study views the **Federated Browser**, which queries the harmonized metadata:

**Clinical Variables (mapped to OMOP CDM)**: - Person: age_at_baseline, sex, race, APOE_genotype - Condition: diagnosis, age_at_diagnosis, cognitive_status - Measurement: mmse_score, moca_score, braak_stage - Specimen: tissue_type, PMI, RIN

**Omics Data**: - 15,234 genes with normalized, z-transformed bulk RNA-seq counts - Cell-type pseudobulked data: neurons, astrocytes, microglia, oligodendrocytes

**Genetics**: - 8.2M variants (imputed + sequenced) in PLINK2 format - Variant naming: $CHR\_$POS\_$REF\_$ALT (e.g., 1_12345_A_G)

### **Phase 2: Cohort Building**

Sarah wants to focus on cases with moderate-to-severe AD pathology and controls, matched for age and sex.

**Cohort Criteria**: - **Cases**: braak_stage \>= 4, diagnosis == "Alzheimer's" - **Controls**: braak_stage \<= 2, cognitive_status == "NCI" - **Age**: 70-85 years - **Tissue**: Dorsolateral prefrontal cortex (DLPFC)

She applies filters in FAIRkit and generates summary statistics:

| Dataset | Cases (n) | Controls (n) | Mean Age | \% Female | Tissue |
|:--------|:----------|:-------------|:---------|:----------|:-------|
| ROSMAP  | 287       | 143          | 79.0     | 58%       | DLPFC  |
| MSBB    | 156       | 89           | 81.9     | 52%       | DLPFC  |

**Cohort Export**: Sarah downloads a **Sample Manifest** (JSON) that includes: - participant_id, dataset, and pointers to data files in FAIRplex buckets and source AMP portals

### **Phase 3: Analysis in Verily Workbench**

Sarah uploads the Sample Manifest to Verily Workbench, which provisions a secure cloud environment with: - **Data access**: Transient, temporary access to FAIRplex-harmonized data for her cohort - **Compute resources**: 16-core VM with 128GB RAM - **Analysis tools**: R, Python, Bioconductor packages

#### *Analysis Workflow*

**Step 1: Load Harmonized Data**
```
import pandas as pd\
import h5py

# Load clinical metadata
clinical = pd.read_hdf('harmonized_20250915/clinical_meta/tabular_data.hdf', key='rosmap_msbb_clinical')

# Load bulk RNA-seq (normalized, z-transformed)
h5py.File('harmonized_20250915/bulk_omics/tabular_data.hdf', 'r') as f:
rosmap_counts = f$$'rosmap_dlpfc_bulk'$$$$:$$
msbb_counts = f$$'msbb_dlpfc_bulk'$$$$:$$
gene_ids = f$$'gene_ensembl_ids'$$$$:$$

# Load genetics (PLINK2)
from pandas_plink import read_plink1_bin
genotypes = read_plink1_bin('harmonized_20250915/genetics/imputed_data.pgen')
```
**Key Features of Harmonized Data**: - **Same column names** across datasets (e.g., age_at_baseline, not age1, Age, age_diagnosis) - **Same numeric scale**: Z-transformed expression values (mean=0, SD=1) enable direct comparison - **Linked by person_id**: Clinical, omics, and genetics data join seamlessly via participant_id

**Step 2: Differential Expression Analysis**

Sarah runs a meta-analysis across ROSMAP and MSBB:
```
from scipy.stats import ttest_ind
import statsmodels.api as sm

# Example: Gene-level t-tests (cases vs. controls)
results = []

for gene_idx in range(len(gene_ids)):
rosmap_case = rosmap_counts$$clinical['diagnosis'$$=='AD', gene_idx]

rosmap_ctrl = rosmap_counts$$clinical['diagnosis'$$=='NCI', gene_idx]

t_stat, p_val= ttest_ind(rosmap_case, rosmap_ctrl)  
results.append({'gene': gene_ids\[gene_idx\], 't': t_stat, 'p': p_val})
results_df = pd.DataFrame(results)
```

Because data is **z-transformed**, effect sizes are comparable across studies. Sarah identifies 342 genes with FDR \< 0.05, enriched for: - Inflammatory pathways (IL6, TNF signaling) - Microglial activation (TREM2, CD33)

**Step 3: Cross-Disease Comparison**

Sarah repeats the analysis with AMP PD and AMP RA/SLE data, leveraging the **same CDEs** and **same pipeline outputs** to compare inflammatory signatures:

| Pathway       | AD (ROSMAP) | PD (BroadPSC) | RA (Phase1) | Overlap  |
|:--------------|:------------|:--------------|:------------|:---------|
| IL6 signaling | ‚Üë 2.3-fold  | ‚Üë 1.8-fold    | ‚Üë 3.1-fold  | 18 genes |
| TNF signaling | ‚Üë 1.9-fold  | ‚Üë 1.4-fold    | ‚Üë 2.7-fold  | 12 genes |

### **Phase 4: Sharing Results via FAIRgit**

Sarah publishes her analysis code to FAIRgit:

<details>
<summary><strong>üìÅ SysBio-FAIRPlex/inflammatory-signatures-AD-PD-RA\/</strong></summary>

```
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ cohort_manifest.json # if able to be shared, pending discussion
‚îú‚îÄ‚îÄ differential_expression.R
‚îú‚îÄ‚îÄ pathway_enrichment.py
‚îî‚îÄ‚îÄ figures
‚îî‚îÄ‚îÄ volcano_plot.png
```
</details>

Her summary statistics are also uploaded to the **SysBio Portal** for public visualization.

------------------------------------------------------------------------

## **User Journey 2: The Data Producer**

### **Making Siloed Data Interoperable**

**Persona**: Dr.¬†James Rodriguez, a bioinformatician at the newly formed AMP X, tasked with integrating newly generated single-cell RNA-seq and genetics data from an inflammatory bowel disease (IBD) cohort into FAIRplex.

### **Phase 1: Understanding Requirements**

James reviews the **SysBio CDM documentation** and identifies three data types to harmonize:

1.  **Clinical data**: Demographics, disease severity, treatment history

2.  **Genetics**: Whole genome sequencing (WGS)

3.  **Single-cell RNA-seq**: Intestinal biopsy samples

**Key Challenges**: - Clinical variables use non-standard names (e.g., PatientAge vs.¬†age_at_baseline) - WGS variants are annotated with dbSNP rsIDs (not standardized CHR_POS_REF_ALT) - scRNA-seq data is in Seurat object format (H5ad, which is technically not HDF5)

### **Phase 2: Clinical Data Mapping to CDEs**

James accesses the **FAIRkit CDE Browser**, which contains CDEs from NLM and FAIRplex datasets.

#### *Step 1: CDE Matching*

He cross-references his data dictionary to FAIRkit‚Äôs **AI-assisted CDE mapping tool**:

| Original Variable | CDE Match | OMOP Table | Notes |
|:-----------------|:-----------------|:-----------------|:-----------------|
| PatientAge | age_at_baseline | Person | Exact match |
| Gender | sex | Person | Values: M‚ÜíMale, F‚ÜíFemale |
| Disease_Duration_Years | disease_duration_years | Condition | New CDE (not in NLM) |
| HarveyBradshawIndex | hbi_score | Measurement | Maps to IBD severity |
| BiologicTreatment | treatment_biologic | Drug_Exposure | Values: Yes/No |

This CDE will be mirrored to the **NLM CDE Repository** for future reuse and interoperability by matching column names and information content and scale.

#### *Step 2: OMOP Transformation*

James runs a Python script to transform his clinical data into OMOP CDM format:
```
# Map to PERSON table

person_df = pd.DataFrame({
'person_id': ibd_data$$'SubjectID'$$,'birth_datetime': 2025 - ibd_data$$'PatientAge'$$, # Derive from age
'gender_concept_id': ibd_data$$'Gender'$$.map({'M': 8507, 'F': 8532}),
'race_concept_id': ibd_data$$'Race'$$.map(race_mapping)
})

# Map to CONDITION_OCCURRENCE*
condition_df = pd.DataFrame({
'person_id': ibd_data$$'SubjectID'$$,
'condition_concept_id': 201606, # SNOMED: Crohn's disease
'condition_start_date': ibd_data$$'DiagnosisDate'$$,
'condition_source_value': 'IBD'
})

# Save as HDF5
person_df.to_hdf('clinical_meta/tabular_data.hdf', key='X_clinical')
```
### **Phase 3: Genetics Data Harmonization**

James‚Äô WGS data is in VCF format with non-standardized variant IDs. He uses the **FAIRplex genetics pipeline** to create interoperable data.

#### *Step 1: Variant Standardization*
```
# Convert to PLINK2 with standardized naming
plink2 --vcf ibd_wgs.vcf.gz
--set-all-var-ids '\@:#:$r:$a'
--new-id-max-allele-len 100
--make-pgen
--out X_standardized

# Output: X_standardized.pgen (PLINK2 binary)
# Variants now named: chr1_12345_A_G (not rs123456)
```
#### *Step 2: Quality Control and Imputation*

Following the **CARD Unified Pipeline** as shown on FAIRkit‚Äôs genetics examples, James: 1. Filters variants (MAF \> 0.01, HWE p \> 1e-6, genotype call rate \> 95%) 2. Imputes missing genotypes using TOPMed reference panel 3. Generates principal components (PCs) to capture population structure
```
# Save genetics metadata with covariates
genetics_meta = pd.DataFrame({
'person_id': sample_ids,
'PC1': pcs$$:, 0$$,
'PC2': pcs$$:, 1$$,
*\# ... PC3-PC10*
'array_or_wgs': 'WGS',
'imputation_panel': 'TOPMed'
})
genetics_meta.to_hdf('genetics/tabular_data.hdf', key='X_ibd_genetics')
```
**Output Files**: - imputed_data.pgen: 10.3M variants in PLINK2 format - tabular_data.hdf: Metadata + PCs for covariate adjustment

### **Phase 4: Single-Cell RNA-seq Harmonization**

James‚Äô scRNA-seq data is in Seurat format (R object). He converts it to FAIRplex-compatible HDF5 with pseudobulked counts.

#### *Step 1: Cell Type Annotation*

Using **Harmony** (a tool recommended in FAIRplex documentation), James integrates his dataset with existing intestinal scRNA-seq references:

library(Seurat)
library(harmony)
```
# Load data*
seurat_obj <- **readRDS**('ibd_scrna.rds')

# Harmonize with reference (e.g., AMP X intestinal atlas)
seurat_obj <- **RunHarmony**(seurat_obj, group.by.vars = 'dataset')

# Annotate cell types
seurat_obj <- FindClusters(seurat_obj, resolution = 0.5)
cell_types <- ('T_cell', 'B_cell', 'Epithelial', 'Macrophage', ...)
seurat_obj$cell_type <- cell_types[seurat_obj$seurat_clusters]
```
#### *Step 2: Pseudobulking and Normalization*

James aggregates counts by cell type and normalizes:

**library**(DESeq2)
```
# Pseudobulk by cell type
pseudobulk <- AggregateExpression**(seurat_obj,
group.by = ('person_id', 'cell_type'),
return.seurat = FALSE)

# Normalize and z-transform
dds <- DESeqDataSetFromMatrix**(countData = pseudobulk,
colData = metadata,
design = ~ diagnosis)
dds <- estimateSizeFactors**(dds)
normalized_counts <- counts(dds, normalized=TRUE)

# Z-transform (mean=0, SD=1) for interoperability
z_transformed <-scale(log2(normalized_counts + 1))
```
**Why Z-transformation?** - Ensures **same numeric scale** across datasets (critical for meta-analysis) - Accounts for technical variation (batch effects, sequencing depth) - Enables direct comparison with existing FAIRplex datasets

#### *Step 3: Export to HDF5*
```
import h5py

withh5py.File('cell_omics/tabular_data.hdf', 'w') as f:
f.create_dataset('X_ibd_intestine_tcells', data=z_transformed$$'T_cell'$$)

f.create_dataset('aim_ibd_intestine_macrophages', data=z_transformed$$'Macrophage'$$)
f.create_dataset('gene_ensembl_ids', data=gene_ids)
```
### **Phase 5: Summary Statistics Generation**

James runs standard analyses to generate summary-level data for the **SysBio Portal**:

#### *Differential Expression*
```
from scipy.stats import ttest_ind

# Compare IBD cases vs. controls (T cells)
results = []
for gene **in** gene_ids:
    case_expr = z_transformed$$'T_cell'$$$$metadata['diagnosis'$$=='IBD', gene]
    ctrl_expr = z_transformed$$'T_cell'$$$$metadata['diagnosis'$$=='Control', gene]

        
    beta, se, p_val = ttest_ind(case_expr, ctrl_expr)  
        results.append({  
        'gene': gene,  
        'cell_type': 'T_cell',  
        'tissue': 'intestine',  
        'beta': beta,  
        'se': se,  
        'p_value': p_val,  
        'n_cases': len(case_expr),  
        'n_controls': len(ctrl_expr),  
        'dataset': 'X_IBD'  
    })

# Save to HDF5*
results_df = pd.DataFrame(results)
results_df.to_hdf('summary_20250915cell_omicsdifferential_expression.hdf',
key='X_ibd_tcell_de')
```
#### *GWAS*
```
# Run PLINK2 association test
plink2 --pgen ibd_standardized.pgen 
--pheno ibd_phenotype.txt 
--covar genetics_covariates.txt 
--glm 
--out ibd_gwas

# Convert to HDF5
python convert_gwas_to_hdf5.py ibd_gwas.assoc.glm
```
**Summary Data Schema** (compatible with SysBio Portal):

| Field      | Description                                          |
|:-----------|:-----------------------------------------------------|
| test       | Gene/variant name (ENSEMBL or CHR_POS_REF_ALT)       |
| beta       | Effect size (log2 fold-change or allele coefficient) |
| se         | Standard error                                       |
| p_value    | P-value from statistical test                        |
| n          | Sample size                                          |
| tissue     | Tissue/cell type (e.g., ‚Äòintestine‚Äô, ‚ÄòT_cell‚Äô)       |
| status     | Case/control or treatment group                      |
| provenance | Source dataset (e.g., ‚ÄòX_IBD‚Äô)                       |

### **Phase 6: Data Return to AMP X**

Once data is harmonized, James coordinates the **data return** via email:

To: AMP X Data Governance Team\
Subject: Harmonized IBD Data Return

Dear Team,

Please find the harmonized AIM_IBD dataset, now interoperable with\
FAIRplex standards:

1. Clinical data: OMOP CDM format (2,340 participants)
2. Genetics: PLINK2 format with standardized variant naming (10.3M variants)
3. Single-cell RNA-seq: HDF5 format with pseudobulked, z-transformed counts

Data location: gs://fairplex-amp-X/harmonized_ibd_20250915/

Summary statistics are now live in the SysBio Portal for public exploration.

Code and documentation: <https://github.com/SysBio-FAIRPlex/X-ibd-harmonization>

Best regards,
James Rodriguez

### **Phase 7: Code Sharing via FAIRgit**

James publishes his harmonization pipeline to FAIRgit:

<details>
<summary><strong>üìÅ SysBio-FAIRPlex/X-ibd-harmonization/</strong></summary>

```
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ clinical_cde_mapping.json
‚îú‚îÄ‚îÄ genetics_pipeline.sh
‚îú‚îÄ‚îÄ scrna_pseudobulk.R
‚îú‚îÄ‚îÄ summary_statistics.py
‚îî‚îÄ‚îÄ notebooks/
‚îú‚îÄ‚îÄ 01_clinical_omop_transform.ipynb
‚îú‚îÄ‚îÄ 02_genetics_qc_imputation.ipynb
‚îî‚îÄ‚îÄ 03_scrna_harmony_integration.ipynb
```
</details>


**Key Pipeline Outputs**:

| Data Type | Input Format  | Output Format     | Tools Used                  |
|:----------|:--------------|:------------------|:----------------------------|
| Clinical  | CSV (custom)  | HDF5 (OMOP)       | Python, FAIRkit CDE mapping |
| Genetics  | VCF           | PLINK2 (.pgen)    | PLINK2, TOPMed imputation   |
| scRNA-seq | Seurat (.rds) | HDF5 (pseudobulk) | Seurat, Harmony, DESeq2     |
| Summary   | N/A           | HDF5              | Python (scipy, statsmodels) |

## **Key Principles Enabling Interoperability**

### **1. Common Data Elements (CDEs)**

**Problem**: Different AMPs use different variable names for the same concept - AMP AD: age1, AMP PD: Age, AMP RA/SLE: age_at_baseline

**Solution**: FAIRkit‚Äôs CDEs provide canonical names and definitions - **Mapping**: age1 ‚Üí age_at_baseline (CDE: NLM-12345) - **Validation**: Expected values, units, and ranges - **Discoverability**: Organized into ‚Äúcollections‚Äù (demographics, clinical, experimental)

### **2. Standardized Data Formats**

**Clinical**: OMOP CDM relational tables (Person, Condition, Measurement, etc.)

**Genetics**: - PLINK2 binary (.pgen) for genotypes - Variant naming: CHR_POS_REF_ALT (e.g., 1_12345_A_G) - Reference genome: GRCh38

**Omics**: - HDF5 format for scalability - Normalized, z-transformed counts (mean=0, SD=1) - Gene IDs: ENSEMBL (unique, specific)

### **3. Uniform Processing Pipelines**

**Example: Bulk RNA-seq Interoperability Pipeline**

Raw FASTQ ‚Üí Alignment (STAR) ‚Üí Quantification (RSEM)\
‚Üí Normalization (DESeq2) ‚Üí Batch Correction (ComBat-Seq)\
‚Üí Z-transformation ‚Üí HDF5 export

**Why Uniform Pipelines Matter**: - **Comparable effect sizes**: Z-scores enable meta-analysis - **Reduced technical variation**: Same algorithms across datasets - **Reproducibility**: Code shared via FAIRgit

**Tools**: CARD Unified Pipeline, ProtPipe, Harmony

### **4. Linked Data via person_id**

All data types connect via person_id (de-identified):

Person (OMOP) ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ Condition_Occurrence\
‚îú‚îÄ‚îÄ‚îÄ Drug_Exposure\
‚îú‚îÄ‚îÄ‚îÄ Measurement\
‚îú‚îÄ‚îÄ‚îÄ Specimen ‚îÄ‚îÄ‚îÄ‚îÄ omics_table ‚îÄ‚îÄ‚îÄ‚îÄ HDF5 (omics data)\
‚îî‚îÄ‚îÄ‚îÄ genetics_table ‚îÄ‚îÄ‚îÄ‚îÄ PLINK2 (genotypes)

This enables queries like: > ‚ÄúFind all participants with APOE4 genotype, Braak stage 5-6, and differential expression of TREM2 in microglia‚Äù

------------------------------------------------------------------------

## **Summary: Operationalizing FAIR Principles**

| FAIR Principle | How FAIRplex Operationalizes It |
|:-----------------------------------|:-----------------------------------|
| **Findable** | FAIRkit Dataset Explorer with searchable CDEs, consent codes, and metadata |
| **Accessible** | Federated authentication via Passport Broker; data in AMP portals + FAIRplex buckets |
| **Interoperable** | OMOP CDM, PLINK2, HDF5, ENSEMBL IDs; z-transformed omics data; uniform pipelines |
| **Reusable** | Open-source code in FAIRgit; summary data in SysBio Portal; documentation |

### **Impact on Research**

**Before FAIRplex**: - Researcher spends 6 months manually harmonizing clinical variables across 3 AMPs - Cannot compare RNA-seq data due to different normalization methods - Meta-analysis requires re-contacting data generators

**With FAIRplex**: - Researcher builds cohort in FAIRkit in 2 hours - Analyzes harmonized data in Verily Workbench immediately - Meta-analysis uses standardized summary statistics in SysBio Portal - Pipeline code is reusable for new datasets via FAIRgit

------------------------------------------------------------------------

## **Conclusion**

The SysBio FAIRplex platform transforms fragmented AMP data into a **federated, interoperable ecosystem** by:

1.  **Standardizing metadata** via Common Data Elements (CDEs)

2.  **Harmonizing data formats** (OMOP, PLINK2, HDF5)

3.  **Normalizing numeric scales** (z-transformation for omics)

4.  **Providing uniform pipelines** (CARD, ProtPipe, Harmony)

5.  **Enabling federated access** (FAIRkit, Verily Workbench)

6.  **Sharing code and results** (FAIRgit, SysBio Portal)

Both user journeys‚Äîthe **Data Consumer** and **Data Producer**‚Äîdemonstrate how researchers operationalize the SysBio CDM to accelerate cross-disease systems biology research while adhering to FAIR principles.

------------------------------------------------------------------------

## **Resources**

-   **FAIRkit**: <https://fairkit-498260019893.us-central1.run.app>

-   **FAIRgit**: <https://github.com/SysBio-FAIRPlex>

-   **SysBio Portal**: <https://sysbio-portal-347771964579.us-central1.run.app>

------------------------------------------------------------------------

*Document Version: 1.0*\
*Last Updated: October 15, 2025*\
*Maintained by: Science and Data Harmonization Core*

------------------------------------------------------------------------

# The Data Landscape

### The AMP Program supports projects across multiple diseases and disorders with the shared goal of improving the understanding of therapeutically relevant biological pathways and identifying therapeutic targets (see[^merged_core_dti_docs-11] to learn more). The AMP Projects support a variety of different studies and generate multiple data modalities, most focused on genetic and omic data generated from disease-relevant tissues. These data are provided to the research community at different processing and summarization levels, accompanied by different phenotypes, specimen, and assay metadata variables. The AMP Projects provide these data to the research community through individual AMP Portals that are specific to each disease area and built on different data hosting architectures. Together, this heterogeneity makes the analysis of data originating from multiple AMP Projects challenging.

[^merged_core_dti_docs-11]: <https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247>

### SysBio FAIRplex aims to unlock the full potential of the AMP Projects by enabling cross-disease systems biology research. It does this through a platform that provides access to primary data originating from the AMP Projects data and data made interoperable through common standards to simplify data discovery and use.

# The AMP Projects

The AMP Program and individual AMP Projects are described by the FNIH[^merged_core_dti_docs-12] and in the SysBio FAIRplex portal[^merged_core_dti_docs-13].

[^merged_core_dti_docs-12]: <https://www.nature.com/articles/npre.2009.3482.1>

[^merged_core_dti_docs-13]: <https://www.ohdsi.org/data-standardization/>

This data landscape documentation focuses on the AMP Projects with genetics and omics (bulk and single cell transcriptomics, and proteomics as a priority) data that are available as of September 2025, or anticipated to become available by the end of the SysBio FAIRplex funding period.

## AMP Projects with available genetics and omics data:

-   [AMP AD](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-alzheimers-disease-2-0/)
    -   Data is hosted in the [AD Knowledge Portal](https://adknowledgeportal.synapse.org/) along with data from a variety of other Alzheimer‚Äôs Disease and Related Dementia programs.
-   [AMP CMD](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-common-metabolic-disorders/)
    -   Data is hosted in the [AMP CMD Knowledge Portal](https://hugeamp.org/) and the [AMP CMD Genome Atlas](https://cmdga.org/)
-   [AMP PD](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-parkinsons-disease/) and [AMP PDRD](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/parkinsons-disease-and-related-disorders/)
    -   Data is hosted in the [AMP PDRD Portal](https://amp-pd.org/)
-   [AMP RA/SLE](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-rheumatoid-arthritis-and-lupus/https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-rheumatoid-arthritis-and-lupus/)
    -   Data is hosted in the [ARK Portal](https://arkportal.synapse.org/)

## AMP Projects that are anticipated to have genetics and omics data within the SysBio FAIRplex funding period:

-   [AMP AIM](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amp-autoimmune-immune-mediated-diseases/)
    -   Data will be hosted in the [ARK Portal](https://arkportal.synapse.org/)
-   [AMP ALS](https://fnih.org/our-programs/accelerating-medicines-partnership-amp/amyotrophic-lateral-sclerosis/)
    -   Data will be hosted in the [ALS Knowledge Portal](https://ampals.synapse.org/)
-   [AMP HF]()
-   Data will be hosted in [BioData Catalyst](https://biodatacatalyst.nhlbi.nih.gov/) - see [AMP SCZ_AMP HF](https://docs.google.com/document/d/1nmyXcV8cfiWlaiD7LVOTF0PeTt3xPUpdWMvDKdKXaxo/edit?tab=t.0#heading=h.x7zvzhlqo74e)

## AMP Projects focusing on data other than genetics and omics:

-   [AMP SCZ](https://www.ampscz.org/)
    -   Data is hosted in [NIMD Data Archive](https://nda.nih.gov/) - see [AMP SCZ_AMP HF](https://docs.google.com/document/d/1nmyXcV8cfiWlaiD7LVOTF0PeTt3xPUpdWMvDKdKXaxo/edit?tab=t.0#heading=h.3ttd2whzur2n)

# AMP Dataset Inventory

Two versions of datasets inventories relevant to SysBio FAIRplex have been generated for the AMP AD, AMP PDRD, and AMP RA/SLE Projects:

## The data harmonization inventory

-   This inventory includes a suggested rating scale for harmonization, which datasets to include in the FAIRkit data inventory, and notes that describe the suggested decisions. This inventory is a guide for SysBio FAIRplex teams and will not be shared publicly through FAIRkit
    -   [2025-05-22-SysBio FAIRplex Studies](https://docs.google.com/spreadsheets/d/1izp_42PyY6Y6CHmyXCHcM59ZEiN50X8BcLNdLpa0sMA/edit?gid=2073762780#gid=2073762780)

## The FAIRkit dataset search inventory

-   This inventory is based on the datasets from the data harmonization inventory recommended to be included in the FAIRkit dataset search. The dataset descriptions in this file have been copied from the respective AMP Projects.
    -   [20250915_AMPDatasets_FAIRkit.xlsx](https://docs.google.com/spreadsheets/d/15DngQVUkyuopJGhPfyIJSB4ejkdwDSVX/edit?gid=786916014#gid=786916014)

# AMP File Inventory

Datasets can be browsed in the [FAIRkit](https://fairkit-498260019893.us-central1.run.app/Datasets) Dataset Explorer (Figure 1) using metadata variables described in more detail in the following sections. Selected datasets can be explored at a more granular level for content that is either open access or controlled for users who have access approval, in the FAIRkit File Explorer (Figure 2)

***Figure 1**: The FAIRkit Dataset Explorer*

![dataset_explorer](assets/image_2.png)


***Figure 2**: The FAIRkit File Explorer*

![file_explorer](assets/image_3.png)




------------------------------------------------------------------------

# Data Curation

Data curation is critical for transforming heterogeneous data into a harmonized, analysis-ready resource. This process ensures data is FAIR, enabling researchers to leverage the full potential of the data accessible via the FAIRplex platform.

This section describes the outputs from the data harmonization and interoperability pipelines, which include:

-   Harmonized metadata describing datasets
-   Interoperable participant-level data
-   Standardized summary-level results from data analyses.

The structure and content of these outputs are described in more detail in the [Data Output](?tab=t.3ddxfjyv3an) section.


## Dataset-level metadata

A FAIRplex dataset is a set of files containing participant-level data of one or more data modalities that meet a specific governance requirement.

Dataset-level metadata is key to finding and cataloging data in FAIRplex and includes:

-   Searchable variables describing assays, biosamples, and disease focus
-   Consent codes describing the data use limitations
-   Relevant experimental documentation and analysis code
-   Data location and provenance
-   Information about data access

## Interoperable individual-level data

Interoperable individual-level data includes clinical data for de-identified individuals that has been made interoperable across datasets, and (as proposed) made compatible with the OMOP open community data standards that can be browsed by tools such as the Verily Data Explorer and FAIRkit.

Individual clinical data is linked to interoperable genetics and omics data. From an analyst-ready perspective, clinical data is a simple data frame linked to collection(s) of common data elements (CDEs), packaged alongside other normalized counts table data frames for each omics modality (proteomics, transcriptomics) within an HDF database, all interoperable. To ease use and tool accessibility, industry-standard formats for genetic data are employed for both variant naming and file formats.

## Summary-level data

Summary-level data derived from the analysis of harmonized or interoperable datasets will be generated in a [schema compatible with HugeAMP](https://hugeamp.org/), allowing for visualization in the FAIRplex portal. HugeAMP is an AMP partnered portal that specializes in modeling, sharing, and visualizing omics and genetic summary-level data from a variety of sources within an established data model. Results prioritized for visualization include summary statistics from differential expression analyses, loadings from principal components analyses, and output from genome-wide association studies (GWAS).

Summary data contains the following data fields:

-   Provenance - the input dataset(s)
-   Status - disease designation or control status
-   Treatment - known interventional treatment group, particularly useful for AMPs with only disease cases or trial-relevant data
-   Tissue - analyte sample was extracted from, generally isolated DNA/RNA, whole blood, mononucleocytes, or a brain region
-   Cell type - cell type annotated via omic clustering methods (i.e. uniform manifold approximation and projection)
-   Beta - from linear or logistic regression
-   Standard error - from linear or logistic regression
-   P value - from linear or logistic regression
-   Test - either the gene or genetic variant name of interest
-   PC1-PC10 - principal component vector loadings
-   N - count of samples in the analysis

A brief summary of the most common data formats per modality is as follows:

| Modality | Raw data format from contributing sources | Intermediate format | Format for data browsers | Analysis ready format | Scale of data |
|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|
| Clinical data | REDCap and/or tabular | SQL database | OMOP compatible database | Tabular | Gigabytes |
| Genetics | iDat, FASTQ and CRAM occasionally VCF or PLINK2 binary | Joint call VCF or PLINK file | Tabular | PLINK2 binary (allele dosages) | Gigabytes to Terabytes |
| Genomics | iDat, FASTQ and CRAM occasionally VCF or PLINK2 binary | Various | Tabular, normalized and scaled counts per gene | Tabular, normalized and scaled counts per gene | Gigabytes to terabytes |
| Summary level | Tabular | Tabular | Tabular | Tabular | Megabytes to gigabytes |

Unless otherwise specified, all genomic and genetic data use gr38 references. For more details please see the section on Data Output.

------------------------------------------------------------------------

# Data Wrangling

The primary goal of the data wrangling in the context of interoperability and harmonization is to create consistent schemas and values across data from various AMP Projects, facilitating analysis across heterogeneous sets of input data. We are focusing on creating AI-ready data, which, at its core, is about data interoperability; The same column header should represent the same information content and the same numeric space across all datasets. Data that cannot be harmonized from raw omics or genetics will be made interoperable using standard conventions as described below. Dataset-level metadata and summary-level analysis results are derived data that can be standardized to a uniform schema to facilitate research.

# Clinical data

Built into FAIRkit is a resource of over 100K common data elements (CDEs), including clinical, demographic, experimental, and governance-related data fields[^merged_core_dti_docs-14]. While NLM vetted CDEs are foundational to this resource, novel CDEs that do not overlap with existing National Library of Medicine CDEs will be indexed at NLM‚Äôs repository in the future to contribute to public knowledge resources and set a standard for upcoming research[^merged_core_dti_docs-15]. CDEs will be organized to represent topics specifically labeled for easy findability, with these labels referred to as ‚Äúcollections‚Äù in the FAIRkit browser. All CDEs that appear in multiple datasets (\> 1) that have been ingested by the FAIRplex team will be annotated as part of this collection, bespoke fields occurring in only one dataset will not be browsable in this iteration of FAIRkit but this may change based on ongoing user feedback.

[^merged_core_dti_docs-14]: <https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247>

[^merged_core_dti_docs-15]: <https://www.nature.com/articles/npre.2009.3482.1>

Each CDE entry contains aliases from published datasets and literature as well as expected values per data field represented by the CDE. CDEs have been modified to be explicit in their naming as opposed to ICD10 codes or similar abbreviations. Clinical, demographic, experimental and governance related CDEs representing data fields from FAIRplex connected studies are audited using an AI-assisted human-in-the-loop protocol to validate content and representativeness. All CDEs will be OMOP compliant whenever possible, following NLM CDE conventions [^merged_core_dti_docs-16].

[^merged_core_dti_docs-16]: <https://www.ohdsi.org/data-standardization/>

Clinical data is dataset specific in many cases and cannot be reprocessed in the same way as \*-omic or genetic data. In this case, FAIRkit will flag values outside of the tolerance levels of established CDEs for manual curation and alteration on a case-by-case basis.

# Genetics and omics data

The initial focus of omics data standardization will be on three data modalities (these may be expanded on over time).

-   Transcriptomics (bulk RNA sequencing or pseudobulk stratified by cell type for single cell or single nucleus)
-   Targeted and untargeted proteomics (from mass spectrometry or arrays)
-   Genetics (from whole genome sequencing or imputed array data).

Depending on the availability of either raw data in standard formats (CRAM, iDat, FASTQ) or data processed into gene expression counts or variant calls, data will be either harmonized or made interoperable. The outputs in either case include PLINK2 binary format for genetic data and counts tables per gene or other functional unit for other omics. For each dataset, notebooks containing code for the harmonization or interoperability work will be provided through FAIRkit and FAIRgit.

## Interoperable genetics and omics

Creating interoperable datasets has three goals: (1) variables should have the same names representing the same data field across datasets, (2) they should be on equivalent numeric scales, and (3) they should be able to be merged together and/or subsetted when the need arises.

Genetic data (from arrays and sequencing) is standardized to dosages of alternate alleles from the reference sequence (gr38) and columns are annotated in the $CHR\_$POS\_$REF\_$ALT format as rsIDs and other nomenclature can be non-specific or redundant. These take the form of PLINK2 binaries.

For transcriptomics and proteomics, normalized counts tables are provided with unique sample IDs. These normalized counts are aggregated on the gene level and appended with ENSEMBL gene IDs, as they are unique and specific. These normalized counts are surveyed for skewness and kurtosis in an automated manner and reviewed by analysts. When necessary, to normalize the data log transformations are undertaken. Residualization via linear regression is used to account for dataset-level covariates such as batch, chemistry, or cell composition, etc on a case-by-case basis for statistical adjustment. Normalized and adjusted data is then z-transformed with either case and/or control groups per dataset as a reference point to scale the data into a uniform numeric space. Principal components analysis of all interoperable omics data is used to generate an additional FAIRplex-specific set of covariates, with 10 component loadings to be available for use in analyses across data sources. Counts data and principal components take the form of tabular data easily readable in R or python housed alongside additional participant-level metadata in dataset-specific HDF files discussed later in the Data Modeling vignette. Industry standard packages such as Harmony[^merged_core_dti_docs-17] will be leveraged for this processing.

[^merged_core_dti_docs-17]: <https://www.nature.com/articles/s41592-019-0619-0>

# Summary level data

Summary-level data is aggregate data summarized across multiple research participants resulting from FAIRplex initiated analyses. These data will be hosted directly by the FAIRplex platform and made available for analysis and visualization through FAIRplex supported tools.

Examples of summary-level data include:

-   Differential expression of harmonized transcriptomics datasets (prioritizing bulk and single cell transcriptomics), which will be carried out using appropriate covariates and standard logistic regression models for all combinations of case/control and treated/untreated status across and within each dataset.
-   Principal component loading per sample, to help visualize the proximity of each dataset to the others within the same numeric projection.
-   GWAS associations summarizing SNP coefficients for various traits in the dataset(s).

Code used for the analysis will be provided to the public in FAIRkit and FAIRgit to deploy and adapt. In addition, other upcoming data wrangling and analysis tooling will be available in Year 2 to facilitate easy meta-analyses across summary-level data provided by the FAIRplex team.

# Additional genetic and omic analysis resources

SysBio FAIRplex stakeholders have prioritized the ability to analyze data across AMP projects for common inflammatory signatures. To address this need, we have identified two areas of community-enabling research resources. The goal is to adopt these with a focus on inflammation and ensure they can scale easily to address multiple disease constellations after receiving feedback from the community.

-   We will generate data-driven networks within known pathways in disease tissues (and cell-types) stratified by case/control or treated/untreated status, highlighting genes in inflammatory pathways using established codebases from the SDH team[^merged_core_dti_docs-18].

-   We will perform pathway and network enrichment analyses from summary statistics for all differential expression analyses, using foundational genetic pathways from the Molecular Signatures Database and the network communities. This will use an existing codebase from the SDH team that has also been previously published[^merged_core_dti_docs-19].

[^merged_core_dti_docs-18]: <https://www.nature.com/articles/s41531-022-00288-w>

[^merged_core_dti_docs-19]: <https://pmc.ncbi.nlm.nih.gov/articles/PMC8422160/>

## Harmonized data

The initial work will focus on making data interoperable. Raw genetic or omics data can be directly harmonized using processes specific to each modality. Transcriptomic and proteomic data from contributing AMPs will be jointly reprocessed from raw data files using tooling developed by members of the Science and Data Harmonization (SDH) team such as ProtPipe or the CARD Unified Multi-omics Pipeline[^merged_core_dti_docs-20]. Genetic data will be reprocessed using a similar approach[^merged_core_dti_docs-21],[^merged_core_dti_docs-22].

[^merged_core_dti_docs-20]: <https://pubmed.ncbi.nlm.nih.gov/38168437/>

[^merged_core_dti_docs-21]: <https://pubmed.ncbi.nlm.nih.gov/38585876/>

[^merged_core_dti_docs-22]: <https://pubmed.ncbi.nlm.nih.gov/30279509/>

Due to the computationally intensive nature of processing raw omics data the focus for now has been on interoperable data. The use of standard pipeline tooling as described above will prospectively harmonize datasets and generally ensure interoperability and efficiency.

------------------------------------------------------------------------

# Data Output

## Outputs from Data Harmonization Pipelines and Schema

SysBio data pipelines process data from source AMP data into a file hierarchy containing harmonized row-level and summary data for each data modality.

#### üì¶ Harmonized Layer (raw standardized data)

| Folder | Contents | Format(s) | Notes |
|--------|----------|-----------|-------|
| `clinical_meta/` | `tabular_data.hdf`, `read_me.txt` | HDF5 | Clinical metadata (CDE-aligned) |
| `bulk_omics/` | `tabular_data.hdf`, `read_me.txt` | HDF5 | Bulk RNA-seq, tissue annotated |
| `cell_omics/` | `tabular_data.hdf`, `read_me.txt` | HDF5 | Single-cell pseudobulk counts |
| `genetics/` | `tabular_data.hdf`, `imputed_data.pgen`, `joint_call.pgen`, `annotation.vcf`, `read_me.txt` | HDF5, PLINK2, VCF | Imputed + joint-called genotypes |

---

### üìä Summary Layer (precomputed analysis outputs)

| Folder | Contents | Format(s) | Notes |
|--------|----------|-----------|-------|
| `bulk_omics/` | `PCA.hdf`, `networks.hdf`, `differential_expression.hdf`, `read_me.txt` | HDF5 | PCA, network models, DE results |
| `cell_omics/` | same as above | HDF5 | Cell-type level analytics |
| `genetics/` | `PCA.hdf`, `GWAS.hdf`, `read_me.txt` | HDF5 | PCA + GWAS summary stats |
| `browsers/` | `external_links.txt`, `read_me.txt` | text | Links to SysBio Portal, etc. |
| `tools_utils/` | `external_links.txt`, `read_me.txt` | text | Companion tools (Harmony, etc.) |

User friendly naming conventions and file formats have been prioritized to lower activation energy for analyses. All HDF5 format files will contain multiple levels of key designated data frames, a majority of which will be counts tables from various omics technologies. The keys will be clearly described in the readme files and will also be named using a user friendly / self-describing style.

Relevant modality data, formatted as described in the [data standardization section](?tab=t.xt7nyccwmpal#heading=h.d950dhj8scei), will be located in the harmonized directory. Summary level data, segmented by modality, will be housed in a dedicated directory. The following SysBio [Common Data Model section](?tab=t.m9m0xmtyjx82#heading=h.59m6yqko37th) will provide a detailed data model explanation, outlining the integration of HDF files with clinical data and metadata.

## Graphical overview of FAIRkit user flow

### Step 1: Federated authentication for the user
![fed_auth](assets/image_4.png)

### Step 2: Analyze and subset harmonized data to datasets and participants of interest
![viewer](assets/image_5.png)


### Step 3: Build a map of your data to take to Verily Workbench
![fed_auth](assets/image_6.png)


### Step 4: Explore existing summary-level data in the portal
![fed_auth](assets/image_7.png)


------------------------------------------------------------------------

# Data Return

The goal of harmonized and/or interoperable data is that they can either be merged and used centrally or federated with the same code running easily across silos. This is a central tenet of NIH‚Äôs AI-readiness plan and key for existing transfer learning applications. Once a dataset is harmonized or made interoperable with other datasets within FAIRplex, this dataset will be returned to its source. We will coordinate returns of data individually for each of the AMPs we interact with, via email communications with their representative(s). Summary statistics and derived level data will be made available in as close to real time as possible to our Broad colleagues for storage, knowledge transfer, and distribution. We will develop a return SOP in collaboration with relevant AMPs as a Year 2 deliverable.

------------------------------------------------------------------------

# The SysBio Common Data Model

## Introduction

The SysBio Common Data Model (SysBio CDM) will provide a standardized framework that defines how data entities, attributes, and relationships are organized across multiple datasets. The SysBio CDM will support consistency, interoperability, and easier integration of data from different sources.

We propose to base the core element of the SysBio CDM on the Observational Medical Outcomes Partnership (OMOP) Common Data Model (CDM)[^merged_core_dti_docs-23] and extend it by modeling relationships from the ‚ÄòPerson‚Äô to specimens, assays, files, and genes, and the upstream dataset relationship. Much of this work was also influenced by foundational efforts from the NLM CDE Catalog and Ontology for Biomedical Investigations (OBI)[^merged_core_dti_docs-24].

[^merged_core_dti_docs-23]: <https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247>

[^merged_core_dti_docs-24]: <https://www.nature.com/articles/npre.2009.3482.1>

The intent is for the SysBio CDM to include the required properties and variables for individual AMPs, facilitating data return. This will allow for queries through SysBio FAIRplex using the harmonized variables and the individual AMPs using AMP specific variables.

This work has been initiated through a survey of data dictionaries and harmonized data elements which support the data standardization, collected from AMP programs. These will be expanded on as additional data is incorporated.

-   The[collectiveAMP_Dictionary](https://docs.google.com/spreadsheets/d/1LQO1K6z6WKNnQMwFU5SWNkfezNViWgOHPMjHCPhSnFQ/edit?usp=drive_link) contains values relevant to clinical data, demographics, sample and assay metadata.

-   The [draft_Harmonized_Data_Dictionary](https://docs.google.com/spreadsheets/d/13WZbPdLqGGqiGEqU1d7OgEI-o0NFcSXPvbIV_FWqP4A/edit?usp=drive_link) contains data fields that are similar across two or more of the AMP‚Äôs. This will act as a working document for users to provide feedback and help to develop a primary dictionary taking into account the further requirements and needs of platform users and resharing of data to the appropriate AMP‚Äôs.

# The SysBio CDM Prototype

A Minimal Viable Product (MVP) using the AMP AD, AMP RA/SEL, AMP PD, and AMP CMD interoperable data, described under the single cell analysis tab, will be used to develop a SysBio CDM prototype. An Entity Relationship Diagram will illustrate the framework for the MVP, while a JSON file will be used to configure the property, type, and permissible variables for each of entity and data exchange.

The SysBio CDM will be managed through FAIRgit and made open access for the research community to use and build on.

# Introduction to OMOP Standards

OMOP is a relational database where each table houses a specific category of data. Below is an overview of the key OMOP tables used in FAIRplex (***Figure 1 OMOP CDM Tables***) and examples of FAIRplex variables mapped to each domain.

The Observational Medical Outcomes Partnership (OMOP) Common Data Model (CDM) is a standardized data model designed to facilitate the analysis of observational healthcare data. It achieves this by providing a structured framework for organizing disparate data sources into a common format, enabling researchers to efficiently and accurately query and analyze data across multiple studies and institutions.

As a note, please refer to the Data Output documentation for details on file formats, structures and content of data in this common data model.

**Key Features**

-   **Standardized Vocabularies:** OMOP CDM utilizes standardized vocabularies and terminologies to ensure consistency and comparability of data across different sources.

-   **Harmonized Relational Structure:** The model employs a relational database structure, where data is organized into interlinked tables, each representing a specific domain of healthcare information

-   **Person-Centric Approach:** OMOP CDM adopts a person-centric approach, with the "Person" table serving as the central table connecting various aspects of patient data and mapping to omics table (additional table for FAIRplex needs )

-   **Flexibility and Extensibility:** While providing a standardized structure, the model allows for flexibility and is extendible across AMPs to accommodate diverse data types and research needs.

***Figure 1** - Reference OMOP Standards from OHDSI*
![omop](assets/image_8.png)


## Clinical Data

We propose to organize clinical data within the SysBio FAIRplex platform according to the OMOP CDM, leveraging its standardized relational structure. This model uses various interconnected tables, such as the ‚ÄúPerson‚Äù table as the central point, to represent different domains of healthcare information. As illustrated in **Figure 2 (Transformation Engine for OMOP Standardization)**, the incoming clinical data undergoes a transformation process to ensure it conforms to the OMOP standards. This engine facilitates the mapping of raw clinical data into the appropriate OMOP CDM tables, ensuring consistent vocabularies, harmonized structures, and a person-centric approach. This transformation enables the data to be interoperable and analyzable across different studies and sources within the FAIRplex platform.

***Figure 2** -Transformation Engine for OMOP Standardization*

![auto_harmonizer](assets/image_9.png)

## Genetics and Omics

We will focus on modeling genetics and transcriptomics and proteomics data. These data types present unique storage and management challenges due to their large volume and complex structure. In the SysBio FAIRplex platform these data will be stored in HDF5 (Hierarchical Data Format version 5) format. HDF5 is a high-performance data storage format designed for storing and organizing large amounts of numerical data allows for the efficient retrieval of complex datasets.

The SysBio CDM will link to the HDF5 file path, establishing the connection between the data and the clinical metadata within the OMOP CDM. The location of the HDF5 files containing the omics data will be referenced within the "omics_table." This means that the data model will not contain the omics data itself, but rather a pointer or file path to where the data is stored in the HDF5 files. This approach allows for efficient storage of the large omics datasets while maintaining a connection to the related clinical and other data within the OMOP CDM. The "omics_table" will contain metadata and the file path that enables linking to the detailed omics data in the HDF5 files

# SysBio CDM Entities

## FAIRplex Clinical Variable Mappings by OMOP Tables

### PERSON

**Purpose:** Store demographic and administrative information.

**Representative AMP Variables:**

-   **Age Fields:** Age, age, age_at_baseline \| age1, age_at_diagnosis, ageDeath, AgeCorrectedStandardScore, ageUnits

-   **Gender & Race:** gender, Sex, Race, race, race2

-   **Education & Family:** education, code_education_12years_complete, FathersEducation, MothersEducation

-   **Administrative: a**dmin, individualID, participant_id

**Mapping Table ‚Äì PERSON**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **age** | Patient age at time of recording | Used to derive birth year or age groups |
| **age_at_diagnosis** | Patient‚Äôs age at time of diagnosis | Used to derive passage of time from diagnosis to point of data recording |
| **age_at_baseline** | Patient‚Äôs age when joining a study |  |
| **age_at_death** |  |  |
| **gender, gender2** | Patient gender | Maps to standardized gender concept |
| **Race, race, race2** | Patient race | Mapped to OMOP race concepts |
| **sex** | Patient sex |  |
| **education, code_education_12years_complete, FathersEducation, MothersEducation** | Education and family background | Custom mapping to PERSON extended attributes |
| **individualID, participant_id** | Unique identifiers | Stored as additional attributes in PERSON |

### VISIT_OCCURRENCE

**Purpose:** Capture encounters and healthcare visits.

**Representative FAIRplex Variables:**

-   visit, visit_id \| visitID, visit_month, visit_name, visitimes, unifiedVisit, intdate, Scan_date

**Mapping Table ‚Äì VISIT_OCCURRENCE**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **visit, visit_id, unifiedVisit** | Unique visit identifiers | Primary key in VISIT_OCCURRENCE |
| **visit_name, visit_month** | Visit type and timing information | Mapped to visit attributes |
| **visitimes, intdate, Scan_date** | Date/time stamps for encounters | Used to derive visit start/end dates |

### CONDITION_OCCURRENCE

**Purpose:** Record diagnoses and clinical conditions.

**Representative FAIRplex Variables:**

-   afib, angina, chd_id, diabetes, parkinsonism, stroke, diagnosis, diagnosis_type, change_in_diagnosis

**Mapping Table ‚Äì CONDITION_OCCURRENCE**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **afib, angina, diabetes, parkinsonism, stroke** | Clinical diagnoses and conditions | Each condition mapped to a standardized concept ID |
| **diagnosis, diagnosis_type** | Detailed diagnosis descriptions | Populated as condition source value |
| **change_in_diagnosis** | Timing of diagnosis changes | Used to capture condition onset or update dates |

### DRUG_EXPOSURE

**Purpose:** Capture medication usage and exposures.

**Representative FAIRplex Variables:**

-   antideprmed, diabeticmed, heartmed, med_desc\_*, med_dose\_*, med_route\_*, med_unit\_*

**Mapping Table ‚Äì DRUG_EXPOSURE**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **antideprmed, diabeticmed, heartmed** | Medication flags (antidepressants, diabetic, cardiac) | Mapped to OMOP drug concept IDs |
| **med_desc\_*, med_dose\_*, med_route\_\*\**, med_unit\_*** | Detailed medication descriptors and dosages | Source fields used for prescription details |

### MEASUREMENT

**Purpose:** House quantitative test results, lab values, and clinical assessments.

**Representative FAIRplex Variables:**

-   chol, HDL, Trig, LDL, bpmed, bmi, bmi_cat, mds_updrs\_*, CATscores\_*, CESD, mmse, moca_total_score, pdq39\_\*

-   Vital signs and lab measures (e.g., Glucose_fasting, CRPhs, CysC)

**Mapping Table ‚Äì MEASUREMENT**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **chol, HDL, Trig, LDL, bpmed, bmi, bmi_cat** | Laboratory values and vital signs | Each mapped to measurement concepts and units |
| **mds_updrs\_*, CATscores\_*, CESD, mmse, moca_total_score, pdq39\_\*** | Cognitive and clinical assessment scores | Stored with measurement_date and value details |
| **Glucose_fasting, CRPhs, CysC, etc.** | Additional lab measurements | Numeric values standardized with unit concepts |

### 4.2.6 OBSERVATION

**Purpose:** Capture survey responses, custom metadata, and non-standard clinical observations

**Representative FAIRplex Variables:**

-   App_version, AppVersion, acknowledgmentStatement, acquisitionMethodType, attention, attention2, memory_loss, datasetName, contentType, consortium, createdBy, createdOn, description, and other study-specific metadata.

**Mapping Table ‚Äì OBSERVATION**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| **App_version, AppVersion, acknowledgmentStatement, acquisitionMethodType** | Application and administrative metadata | Mapped as observation source value |
| **attention, attention2, memory_loss** | Survey responses or clinical observations | Stored with observation_date and value as text/number |
| **datasetName, consortium, createdBy, createdOn, description** | Dataset-level metadata | Populated as custom observations or in a separate metadata table |

### 4.2.7 SPECIMEN

**Purpose:** Manage biospecimen details, including sample identifiers and types.

**Representative FAIRplex Variables:**

-   biospecimenType, specimenID, sample_id, Plate_ID, sampleBatch, Sample_Type, Sample_Description

**Mapping Table ‚Äì SPECIMEN**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| biospecimenType, specimenID, sample_id, Plate_ID | Biospecimen identifiers and type information | Mapped as primary specimen attributes |
| sampleBatch, Sample_Type, Sample_Description | Additional specimen collection details | Included as specimen source value or extension fields |

### 4.2.8 FACT_RELATIONSHIP and Additional Metadata

**Purpose: Define relationships between facts and capture audit/metadata attributes.**\
**Representative FAIRplex Variables:**

-   **ROW_ID, ROW_VERSION, parentId, duplicateID, metadataType, createdBy, modifiedBy, modifiedOn, etc.**

**Mapping Table ‚Äì FACT_RELATIONSHIP / Metadata**

| AMP Data Element(s)(Direct from AMPs) | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| ROW_ID, ROW_VERSION, parentId, duplicateID | Relationship identifiers and versioning | Used to maintain referential integrity across domains |
| metadataType, createdBy, modifiedBy, modifiedOn | Audit and provenance information | Stored in accompanying audit tables or as part of each record‚Äôs metadata |

## 4.3 Additional Tables

### 4.3.1 omics_table

| Column Name | Description                                 | Mapping Details |
|-------------|---------------------------------------------|-----------------|
| omics_id    | Unique identifier for the omics data entry. |                 |
| protocol_id | Identifier for the experimental protocol.   |                 |
| specimen_id | Identifier for the biospecimen used.        |                 |
| person_id   | Identifier for the person associated.       |                 |
| concept_id  | Identifier for the concept related.         |                 |

### 4.3.2 protocol_table: To store detailed protocol information.

| Column Name | Description | Mapping Details |
|------------------------|------------------------|------------------------|
| protocol_id | Unique identifier for the protocol used. |  |
| file_path | Path to the omics data file. |  |
| assay_type | Type of omics assay performed may be cataloged in a assay_table |  |

\*\*Further modifications to the OMOP CDM may be required depending on the specific FAIRplex implementation and data requirements as we keep evolving with more AMP‚Äôs. These may include:

-   **specimen_table:** To capture additional specimen details.

-   **assay_type_table:** To maintain a controlled vocabulary of assay types.

# Conclusion

The SysBio FAIRplex project will employ a robust data model to integrate and harmonize diverse datasets, from AMP Projects. At its core, we propose to leverage the OMOPCDM, a standardized relational database designed for observational healthcare data. Clinical data will be organized into OMOP CDM tables, ensuring interoperability and enabling cross-study analysis. Genetics and Omics data (transcriptomics, and proteomics), will be stored efficiently in HDF5 format, with file paths referenced within the ‚Äúomics_table‚Äù to link to the larger datasets while maintaining a connection to the clinical metadata. The MVP prototype will be used to develop entity relationships, properties, and variables, and will illustrate the relationships between key entities, including how omics file paths are connected to protocol and sample tables.

------------------------------------------------------------------------

![fed_auth](assets/image_10.png)

# FAIRkit

*What is FAIRkit*[^merged_core_dti_docs-25]? FAIRkit is a search tool designed to help researchers find and interpret the vast number of resources across the collection of AMP programs, as well as outputs from the SysBio FAIRplex harmonization efforts. For more information, please check the [ReadMe](https://docs.google.com/document/d/1o_dMlZhIpucZGtEF9eofafJ3Mwk8GFkrR38zAQ_ZxAU/edit?usp=sharing) and [demo video](https://drive.google.com/file/d/1s68uUPHb78qIkNahJk7EgeQmKqdoyk5m/view?usp=sharing).

[^merged_core_dti_docs-25]: [*https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247*](https://fairkit-498260019893.us-central1.run.app/?state=1826fc0b-bad3-4704-aa14-5b498d4c8247){.uri}

*Where is the data, and what is there?* FAIRkit uses a form structure to inventory study-level metadata, including sharing permissions, governance, and data location both in FAIRplex buckets and in the contributing AMP.

*What do these data fields represent?* FAIRkit already contains over 110k common data elements (CDEs) that incoming clinical data can be matched to. Its offline tooling ensures that each data field across interoperable datasets have the same names and represents the same meanings, units of measure and valid ranges. New CDEs can also be generated rapidly leveraging AI-assistance when needed. A collection of CDEs for all clinical and experimental data fields in FAIRplex datasets will be browsable by users and will also be mirrored by the National Library of Medicine‚Äôs CDE repository in the near future.

*How was this data made and harmonized?* All available documentation for experimental procedures associated with FAIRplex datasets, along with analysis and data management code, are indexed and summarized using AI-assistance to facilitate findability and intelligibility across groups of scientists from diverse scientific disciplines.

*What about federated data?* Logging in to FAIRkit will populate your federated authentication across the SysBio ecosystem. Through our graphical user interface (GUI), you can explore harmonized and centralized data of interest to the research community across multiple modalities without writing any code.

*Can I build a cohort?* Go right ahead. Through the federated data access, which is transient and temporary for that login, you can export a ‚Äúshopping list‚Äù style inventory of samples of interest at each AMPs where the bulk of connected data is stored long term. Find the samples you want, use the provenance and findability data you just downloaded to go on a deep dive in BAM files or brain images at the host AMP without having to look for hours.

------------------------------------------------------------------------

# FAIRgit

FAIRgit serves as the central GitHub organization for the SysBio FAIRplex Project, designed to promote collaborative, transparent, and reproducible research following FAIR (Findable, Accessible, Interoperable, Reusable) principles. This document outlines the organizational structure, development workflows, and coding standards that govern all repositories within the FAIRgit ecosystem.

# See: <https://github.com/SysBio-FAIRPlex/FAIRgit>

------------------------------------------------------------------------
